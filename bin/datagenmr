#!/bin/bash

# Resolve Symlinks of exe
RESOLVED_EXE_PATH=`readlink -f $0`
# Find Dir of resolved script
APP_DIR=$(dirname $RESOLVED_EXE_PATH)
CURR_DIR=$(pwd)

# Choose to use embedded libs (Hadoop 3+) or get Hadoop Classpath locally
if [[ -f $APP_DIR/../lib/iot-data-utility-shaded.jar ]]; then
  # Look in /usr/local/iot-data-utility/lib
  APP_JAR=$APP_DIR/../lib/iot-data-utility-shaded.jar
  #echo "Using bin from installation directory"
else
  echo "Couldn't locate iot-data-utility Library: ${APP_DIR}/../lib/iot-data-utility-shaded.jar"
  exit 1
fi

MAIN=com.streever.iot.data.mapreduce.DataGenTool

#hadoop jar $APP_JAR $MAIN --libjars $GENJARS -json.cfg $1 -count $2 -mappers $3 -output $4
#hadoop jar $APP_JAR $MAIN -jsonCfg $1 -count $2 -mappers $3 -output $4
hadoop jar $APP_JAR $MAIN $@
